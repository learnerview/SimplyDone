<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{fragments/head :: head}" th:with="title='Source Code â€” SimplyDone'" />
<body>
    <th:block th:replace="~{fragments/sidebar}" th:with="active='source'" />
    <div class="main">
        <h1 class="page-title">Source Code &amp; Architecture</h1>

        <div class="card">
            <h3>GitHub Repository</h3>
            <p style="margin-top: .5rem;">
                <a href="https://github.com/learnerview/simplydone"
                   target="_blank" rel="noopener"
                   style="color: var(--accent); text-decoration: none; font-size: 1.1rem; font-weight: 600;">
                    github.com/learnerview/simplydone
                </a>
            </p>
            <p style="color: var(--text-muted); margin-top: .5rem;">
                Open-source distributed job scheduler built with Spring Boot, Redis, and PostgreSQL.
            </p>
        </div>

        <div class="card" style="margin-top: 1.5rem;">
            <h3>What is SimplyDone?</h3>
            <p style="margin-top: .5rem;">
                SimplyDone is a production-grade <strong>distributed job scheduling system</strong> that demonstrates
                advanced backend patterns: deficit round-robin scheduling, sliding-window rate limiting,
                exponential-backoff retries, DAG-based workflow orchestration, and a dead-letter queue for
                failed jobs.
            </p>
        </div>

        <div class="grid grid-4" style="margin-top: 1.5rem;">
            <div class="card">
                <h3>Backend</h3>
                <p style="margin-top: .5rem;">Java 17, Spring Boot 3, Spring Data JPA, Hibernate</p>
            </div>
            <div class="card">
                <h3>Queue</h3>
                <p style="margin-top: .5rem;">Redis sorted sets with Lettuce client, TLS support</p>
            </div>
            <div class="card">
                <h3>Database</h3>
                <p style="margin-top: .5rem;">PostgreSQL (prod), H2 in-memory (dev/test)</p>
            </div>
            <div class="card">
                <h3>Frontend</h3>
                <p style="margin-top: .5rem;">Thymeleaf server-side rendering, vanilla JS</p>
            </div>
        </div>

        <div class="card" style="margin-top: 1.5rem;">
            <h3>Architecture Highlights</h3>
            <table>
                <thead>
                    <tr>
                        <th>Pattern</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Deficit Round-Robin</strong></td>
                        <td>Weighted priority scheduling (high 70%, normal 20%, low 10%) ensures fairness across queue tiers</td>
                    </tr>
                    <tr>
                        <td><strong>Sliding Window Rate Limiting</strong></td>
                        <td>Per-user rate limiting using Redis sorted sets with configurable window (default 60 req/min)</td>
                    </tr>
                    <tr>
                        <td><strong>Exponential Backoff Retries</strong></td>
                        <td>Failed jobs are retried with exponentially increasing delays before moving to DLQ</td>
                    </tr>
                    <tr>
                        <td><strong>DAG Workflow Orchestration</strong></td>
                        <td>Multi-job workflows with dependency resolution &mdash; jobs execute only after dependencies complete</td>
                    </tr>
                    <tr>
                        <td><strong>Dead Letter Queue</strong></td>
                        <td>Permanently failed jobs are moved to DLQ for inspection and manual retry</td>
                    </tr>
                    <tr>
                        <td><strong>SOLID Service Layer</strong></td>
                        <td>Interface-driven design with separated concerns: services, mappers, repositories</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="card" style="margin-top: 1.5rem;">
            <h3>REST API Endpoints</h3>
            <table>
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Endpoint</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="badge badge-success">POST</span></td>
                        <td><code>/api/jobs</code></td>
                        <td>Submit a new job</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-success">POST</span></td>
                        <td><code>/api/jobs/workflow</code></td>
                        <td>Submit a multi-job workflow with dependencies</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-queued">GET</span></td>
                        <td><code>/api/jobs</code></td>
                        <td>List all jobs (paginated)</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-queued">GET</span></td>
                        <td><code>/api/jobs/{id}</code></td>
                        <td>Get a specific job by ID</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-failed">DELETE</span></td>
                        <td><code>/api/jobs/{id}</code></td>
                        <td>Cancel a queued job</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-queued">GET</span></td>
                        <td><code>/api/jobs/types</code></td>
                        <td>List registered job handler types</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-queued">GET</span></td>
                        <td><code>/api/jobs/health</code></td>
                        <td>Application health with queue stats</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-queued">GET</span></td>
                        <td><code>/api/admin/stats</code></td>
                        <td>Queue and job statistics</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-queued">GET</span></td>
                        <td><code>/api/admin/queues</code></td>
                        <td>Queue sizes by priority</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-failed">DELETE</span></td>
                        <td><code>/api/admin/queues</code></td>
                        <td>Clear all queues</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-queued">GET</span></td>
                        <td><code>/api/admin/dlq</code></td>
                        <td>List dead-lettered jobs</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-success">POST</span></td>
                        <td><code>/api/admin/dlq/{id}/retry</code></td>
                        <td>Retry a dead-lettered job</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-queued">GET</span></td>
                        <td><code>/api/admin/handlers</code></td>
                        <td>List registered handlers</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="card" style="margin-top: 1.5rem;">
            <h3>UI Pages</h3>
            <table>
                <thead>
                    <tr>
                        <th>Path</th>
                        <th>Page</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>/</code></td>
                        <td>Dashboard</td>
                        <td>Queue stats, recent jobs, registered handlers overview</td>
                    </tr>
                    <tr>
                        <td><code>/jobs</code></td>
                        <td>Jobs</td>
                        <td>Submit new jobs, view job list, cancel jobs</td>
                    </tr>
                    <tr>
                        <td><code>/admin</code></td>
                        <td>Admin</td>
                        <td>Queue management, clear queues, system stats</td>
                    </tr>
                    <tr>
                        <td><code>/dlq</code></td>
                        <td>Dead Letter Queue</td>
                        <td>View and retry permanently failed jobs</td>
                    </tr>
                    <tr>
                        <td><code>/source</code></td>
                        <td>Source Code</td>
                        <td>This page &mdash; architecture, endpoints, GitHub link</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="card" style="margin-top: 1.5rem;">
            <h3>Project Structure</h3>
            <pre style="color: var(--text-muted); font-size: .85rem; line-height: 1.8; overflow-x: auto;">com.learnerview.simplydone/
  config/          DatabaseConfig, RedisConfig, SchedulerProperties
  controller/      JobController (REST), AdminController (REST), ViewController (UI)
  dto/             Request/Response objects, API wrapper
  entity/          JobEntity (JPA)
  exception/       Custom exceptions + global handler
  handler/         JobHandler interface, Registry, demo handlers (echo, email, report)
  mapper/          JobMapper (entity-DTO conversion)
  model/           Enums: JobPriority, JobStatus
  repository/      QueueRepository (interface), RedisQueueRepository, JobEntityRepository
  service/         Interfaces: JobSubmission, JobExecutor, Admin, Workflow, RateLimiter, Retry
  service/impl/    Implementations of all service interfaces
  SchedulerEngine  Deficit round-robin poller</pre>
        </div>
    </div>
</body>
</html>
